input {
	file {
		path => '/Users/shaunak/development/github/ycombinator/presentations/2016-05-19-nebraska-code-elasticsearch-fundamentals/data/devops_borat.txt'
		start_position => beginning
	}
}

filter {
	csv {
		separator => '|'
		quote_char => "|"
	}
	mutate {
		rename => { "column1" => "tweet_id" }
		rename => { "column2" => "timestamp" }
		rename => { "column3" => "message" }
	}
	date {
		match => [ "timestamp", "EEE MMM dd HH:mm:sss Z yyyy"]
	}
	mutate {
		remove_field => [ "timestamp", "@version", "host", "path" ]
	}
}

output {
	stdout {
		codec => json
	}
	elasticsearch {
		document_type => "tweet"
    document_id => "%{tweet_id}"
		index => "twitter"
	}
}
